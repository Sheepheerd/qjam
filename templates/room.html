<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Stream Aggregator</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  </head>
  <body class="container">

    <h1>Audio Aggregator</h1>



    <label for="search">Search YouTube or Paste URL:</label>

    <div class="search-container" style="position: relative;">

      <input type="text" 
	id="url-input"
	name="query" 
	placeholder="Search song..." 
	autocomplete="off"
	hx-post="/search" 
	hx-trigger="keyup changed delay:500ms" 
	hx-target="#search-results">

      <ul id="search-results" 
	role="listbox" 
	style="position: absolute; 
	top: 100%; 
	left: 0; 
	right: 0; 
	z-index: 100; 
	background: #1f2937; 
	border: 1px solid #374151; 
	list-style: none; 
	padding: 0; 
	margin: 0;
	max-height: 200px; 
	overflow-y: auto;">
      </ul>

    </div>

    <form hx-post="/{{ room.session_id }}/queue" hx-target="#input-wrapper">
      <input type="hidden" name="url" id="hidden-submission-url">
      <button type="submit" onclick="document.getElementById('hidden-submission-url').value = document.getElementById('url-input').value">
	Queue Selected Song
      </button>
    </form>

    <h3>Current Queue</h3>

    <ul id="queue-list"
      style="max-height: 300px; overflow-y: auto; list-style: none; padding: 0;"
      hx-get="/{{ room.session_id }}/queue"
      hx-trigger="every 2s"
      hx-swap="innerHTML">
    </ul>

    <form hx-post="/{{ room.session_id }}/queue" hx-target="#input-wrapper" hx-swap="innerHTML">
      <div class="grid">

	<div id="input-wrapper">
	</div>

      </div>
    </form>


    <form hx-post="/play" hx-target="#player-container" hx-swap="innerHTML">
      <button type="submit">Play Top of Queue</button>
    </form>

    <div id="player-container">
    </div>

  </body>
</html>
